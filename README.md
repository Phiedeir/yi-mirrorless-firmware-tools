# YI M1 Mirrorless Camera Firmware Tools ğŸ“¸  
YI M1 å¾®å•ç›¸æœºå›ºä»¶å·¥å…· ğŸ› ï¸

[English](#english) | [ä¸­æ–‡](#ä¸­æ–‡è¯´æ˜)

---

## English ğŸ‡ºğŸ‡¸

Firmware tools / unpacker for the YI M1 mirrorless camera.

> This is a fork, just update something. ğŸ”„

A firmware unpacker & repacker for YI M1 firmware files. Parses the section headers of a firmware file, extracts the sections into separate files, and splits and decompresses the firmware code sections.

### Requirements âš™ï¸

- [Node.js & npm](https://nodejs.org) (recommended: v8.10.0 LTS)

### Usage ğŸš€

1. `npm install`
2. Download [firmware](https://www.yitechnology.com/yi-m1-mirrorless-camera-firmware)
3. Run any of the supported commands:
   - `npm run unpack /path/to/firmware.bin` â€” Unpack the firmware file into separate (decompressed) files
   - `npm run repack /path/to/firmware.bin` â€” Repack unpacked data into a flashable firmware file (needs the `.unpack` metadata file generated by the `unpack` command). **âš ï¸ Warning: flashing generated files may damage your camera!**
   - `npm run flipregion /path/to/firmware.bin` â€” Change the region between CN and INT

The output will be a number of files (usually 4) named `firmware.bin.{sectionNumber}[.{sectionId}]`.

**âš ï¸ ATTENTION: the firmware decompression/compression is not yet 100% correct, do not attempt to flash a repacked firmware file or it may damage the camera!**

---

## ä¸­æ–‡è¯´æ˜ ğŸ‡¨ğŸ‡³

YI M1 å¾®å•ç›¸æœºå›ºä»¶å·¥å…· / è§£åŒ…å·¥å…·

> æœ¬é¡¹ç›®ä¸ºåˆ†æ”¯ï¼Œä»…åšéƒ¨åˆ†æ›´æ–°ã€‚ğŸ”„

æ”¯æŒ YI M1 å›ºä»¶çš„è§£åŒ…ä¸é‡æ‰“åŒ…ï¼Œèƒ½è§£æå›ºä»¶æ–‡ä»¶çš„å„ä¸ªåŒºå—å¤´éƒ¨ï¼Œå°†åŒºå—æå–ä¸ºç‹¬ç«‹æ–‡ä»¶ï¼Œå¹¶åˆ†å‰²ä¸è§£å‹å›ºä»¶ä»£ç åŒºå—ã€‚

### ç¯å¢ƒéœ€æ±‚ âš™ï¸

- [Node.js å’Œ npm](https://nodejs.org)ï¼ˆæ¨è v8.10.0 LTSï¼‰

### ä½¿ç”¨æ–¹æ³• ğŸš€

1. `npm install`
2. ä¸‹è½½[å›ºä»¶](https://www.yitechnology.com/yi-m1-mirrorless-camera-firmware)
3. æ‰§è¡Œæ”¯æŒçš„å‘½ä»¤ï¼š
   - `npm run unpack /path/to/firmware.bin` â€” è§£åŒ…å›ºä»¶ä¸ºç‹¬ç«‹ï¼ˆå·²è§£å‹ï¼‰æ–‡ä»¶
   - `npm run repack /path/to/firmware.bin` â€” å°†è§£åŒ…æ•°æ®é‡æ–°æ‰“åŒ…ä¸ºå¯åˆ·å†™çš„å›ºä»¶ï¼ˆéœ€è¦ `unpack` å‘½ä»¤ç”Ÿæˆçš„ `.unpack` å…ƒæ•°æ®ï¼‰ã€‚**âš ï¸è­¦å‘Šï¼šåˆ·å†™ç”Ÿæˆçš„æ–‡ä»¶å¯èƒ½æŸåç›¸æœºï¼**
   - `npm run flipregion /path/to/firmware.bin` â€” æ›´æ”¹å›ºä»¶åŒºåŸŸï¼ˆCN/INTï¼‰

è¾“å‡ºé€šå¸¸ä¸º 4 ä¸ªåä¸º `firmware.bin.{sectionNumber}[.{sectionId}]` çš„æ–‡ä»¶ã€‚

**âš ï¸æ³¨æ„ï¼šå›ºä»¶è§£å‹/å‹ç¼©å°šæœªå®Œå…¨æ­£ç¡®ï¼Œåˆ·å†™é‡æ‰“åŒ…å›ºä»¶å¯èƒ½å¯¼è‡´è®¾å¤‡æŸåï¼**

---

## Firmware analysis / å›ºä»¶åˆ†æ ğŸ”¬

Firmware files consist of 4 sections.  
å›ºä»¶æ–‡ä»¶åŒ…æ‹¬ 4 ä¸ªåŒºå—ï¼š

| Section Number | Section Id | Size                  | Description (EN) | æè¿°ï¼ˆä¸­æ–‡ï¼‰        |
| -------------- | ---------- | --------------------- | ---------------- | ------------------- |
| 0              | *none*     | variable, ~7 MB       | Firmware code, contains compressed data sections | å›ºä»¶ä»£ç ï¼Œå«å‹ç¼©åŒºå— |
| 1              | ND1        | variable, ~4 MB       | Memory image with resources (bitmaps, fonts, texts) | èµ„æºåŒºå—ï¼ˆä½å›¾/å­—ä½“/å¤šè¯­è¨€æ–‡æœ¬ï¼‰ |
| 2              | IPL        | 128 kB, 0x20000 bytes | Bootloader (Initial Program Loader) | å¼•å¯¼åŠ è½½ç¨‹åº |
| 3              | PTBL       | 4 kB, 0x1000 bytes    | Partition table, unknown format | åˆ†åŒºè¡¨ï¼ˆæœªçŸ¥æ ¼å¼ï¼‰ |

### Section headers / åŒºå—å¤´éƒ¨ ğŸ“

Section headers are simple 256-byte strings. Examples:

```
LENGTH=7366656 C59Y1 VER=M1INT DVR=Ver1.37 SUM=937214718 ND1 IPL PTBL
ND1 LENGTH=4197888 C59Y1 VER=M1INT DVR=Ver1.37 SUM=299791776 OFFSET=23068672
IPL LENGTH=131072 C59Y1 VER=M1INT DVR=Ver1.37 SUM=5714438
PTBL LENGTH=4096  C59Y1 VER=M1INT SUM=5181
```

- `LENGTH`ï¼šåŒºå—ä½“é•¿åº¦ï¼ˆå­—èŠ‚ï¼‰
- `SUM`ï¼šç®€å•æ ¡éªŒå’Œ
- `OFFSET`ï¼šå†…å­˜åç§»åœ°å€

### Hardware & Software Identification / ç¡¬ä»¶ä¸è½¯ä»¶æ ‡è¯† ğŸ› ï¸

Run Unix `strings` utility against the decompressed firmware for interesting system/hardware strings.

#### Section 0 / ç³»ç»Ÿ
- C:/XC_ODM/sdk/SDK_selfcheck/src/EV9x_DevEnv/btstack/bluesdk
- BCM4343A1_001.002.009.0043.0178 (Wifi)
- BCM4343WA1 37.4MHz Murata Type-1FJ BT4.1 OTP-BD-0043 (Bluetooth)
- Copyright (c) 2009-2010 Tokyo Electron Device Ltd
- Broadcom BCM.%s 802.11 Wireless Controller %s
- il0macaddr=00:90:4c:c5:12:38 (Broadcom MAC)
- bcm943430wlselgs_20150609__1FJ_lp2.txt
- Copyright 2009 Murata Manufacturing Co.,Ltd

#### Section 2 / IPL
- PureNAND IPL ev9x-v1.8t.r1864 (Mimasaka) [DEBUG BUILD] (Feb 10 2016 10:30:54)
- EV9XES1.0 / EV9XES2.0
- ARM926_1 / ARM926_2 (armv5te architecture)
- BCH2K124

### Camera Software / ç›¸æœºè½¯ä»¶ ğŸï¸

#### Wifi / HTTP Server
When paired, the camera sets a Wifi password (8 digits) visible via Android app `logcat`.

---

## Next steps / åç»­è®¡åˆ’ ğŸ¯

- Identify partition table format and decode / è¯†åˆ«å¹¶è§£ç åˆ†åŒºè¡¨æ ¼å¼
- Disassemble first section / åæ±‡ç¼–ç¬¬ä¸€ä¸ªåŒºå—
- Change simple things (e.g. 500 shot limit), repack and upload / ä¿®æ”¹å›ºä»¶ï¼ˆå¦‚æ‹æ‘„å¼ æ•°é™åˆ¶ï¼‰ï¼Œé‡æ‰“åŒ…å¹¶ä¸Šä¼ 

---

## Other Cameras / å…¶å®ƒç›¸æœº ğŸ¥

The Fujifilm X-A10 camera uses the same [firmware format](http://www.fujifilm.com/support/digital_cameras/software/firmware/x/xa10/download.html) and can be unpacked with this tool.  
å…¶ä»–å¯Œå£«ç›¸æœºï¼ˆå¦‚ Finepix S800ï¼‰å›ºä»¶æ ¼å¼ç±»ä¼¼ï¼Œä½†å¤´éƒ¨æ›´çŸ­ï¼Œæš‚ä¸æ”¯æŒè§£åŒ…ã€‚

---

## FAQ ğŸ’¡

**Q: What's the purpose of this tool? / å·¥å…·ç”¨é€”ï¼Ÿ**  
A: For firmware hacking, analysis, and region change. / ç”¨äºå›ºä»¶åˆ†æã€ç ´è§£å’ŒåŒºåŸŸè½¬æ¢ã€‚

**Q: What can a potential firmware hack do? / å›ºä»¶ç ´è§£èƒ½åšä»€ä¹ˆï¼Ÿ**  
A:  
- Increase video bitrates / æé«˜è§†é¢‘ç ç‡
- Add 24p video modes / å¢åŠ  24p è§†é¢‘æ¨¡å¼
- Decrease JPEG compression / é™ä½ JPEG å‹ç¼©
- Change focus peaking color / ä¿®æ”¹å¯¹ç„¦å³°å€¼é¢œè‰²
- Fix UX issues / ä¿®å¤ç”¨æˆ·ä½“éªŒé—®é¢˜
  - e.g. disable full shutter press during video recording

**Q: How can I contribute? / å¦‚ä½•è´¡çŒ®ï¼Ÿ**  
A: Please open an issue, pull request, or email:  
mg@protyposis.net  
æˆ–è”ç³» xiaolu34702@gmail.com äº†è§£åˆ†æ”¯é—®é¢˜

**Q: Why JavaScript? / ä¸ºä»€ä¹ˆç”¨ JavaScriptï¼Ÿ**  
A: Easier string manipulation, cross-platform via Node.js.

---
